"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[15],{3657:function(e,t,a){a.d(t,{oL:function(){return l},bt:function(){return s},aK:function(){return u},eb:function(){return i},lB:function(){return d},k7:function(){return r},fw:function(){return f},ot:function(){return w}});var n,l,o=a(4042);let r=e=>e.global.windowsOpen,i=(0,o.P1)(r,e=>t=>e.some(e=>e.window===t)),d=(0,o.P1)(r,e=>t=>e.find(e=>e.window===t)),s=e=>e.global.isLoading,u=(0,o.P1)(r,e=>t=>e.some(e=>e.window===t)&&e[e.length-1].window===t);(n=l||(l={})).Deposit="Deposit",n.Swap="Swap",n.Transfer="Transfer",n.Referral="Referral",n.AddWallet="AddWallet",n.Networks="Networks",n.WalletsList="WalletsList",n.AddToken="AddToken",n.TransactionsHistory="TransactionsHistory",n.WalletDetails="WalletDetails",n.TransactionDetails="TransactionDetails",n.ImportWallet="ImportWallet",n.CreateWallet="CreateWallet",n.PrepareTransfer="PrepareTransfer",n.ConfirmTransfer="ConfirmTransfer",n.ConfirmSwap="ConfirmSwap",n.SelectFromToken="SelectFromToken",n.SelectToToken="SelectToToken",n.TokenDetails="TokenDetails",n.TokenInfo="TokenInfo";let c=(0,a(2351).oM)({name:"global",initialState:{isLoading:!1,windowsOpen:[]},reducers:{setLoading:(e,t)=>{e.isLoading=t.payload},addWindow:(e,t)=>{e.windowsOpen.some(e=>e.window===t.payload.window)||(e.windowsOpen=[...e.windowsOpen,t.payload])},removeWindow:(e,t)=>{e.windowsOpen=e.windowsOpen.filter(e=>e.window!==t.payload)},removeAllWindows:e=>{e.windowsOpen=[]},removeLastWindow:e=>{e.windowsOpen.pop()}}}),{reducer:w}=c,{actions:f}=c},7833:function(e,t,a){a.d(t,{fK:function(){return r}});var n=a(385),l=a(2433),o=a(3657);let r=a(1101).h.injectEndpoints({endpoints:e=>({getWallet:e.query({query:e=>({url:"/wallets/wallet/".concat(e)}),onQueryStarted:async(e,t)=>{let{dispatch:a,queryFulfilled:r,getState:i}=t;try{var d;a(o.fw.setLoading(!0));let e=await r,t=(0,n.KR)(i());(null==e?void 0:null===(d=e.data)||void 0===d?void 0:d.data)&&(a(l.vB.setSelectedWallet(e.data.data)),t||a(l.vB.setSelectedNetwork(e.data.data.network)))}finally{a(o.fw.setLoading(!1))}}}),getTokenTransactions:e.query({query:e=>({url:"/wallets/token-transactions",params:e})}),getWallets:e.query({query:()=>({url:"/wallets/list"})}),transfer:e.mutation({query:e=>({url:"/wallets/transfer",method:"POST",body:e}),async onQueryStarted(e,t){let{dispatch:a,queryFulfilled:n}=t;a(l.vB.setIsLoading(!0));try{let{data:t}=await n;t&&t.data&&a(l.vB.updateTokenAfterTransfer({transferParams:e,newBalance:t.data.newTokenBalance,newWalletBalance:t.data.newWalletBalance}))}finally{a(l.vB.setIsLoading(!1))}}}),createWallet:e.mutation({query:e=>({url:"/wallets/create",method:"POST",body:e})}),importWallet:e.mutation({query:e=>({url:"/wallets/import",method:"POST",body:e})}),deleteWallet:e.mutation({query:e=>({url:"/wallets/delete",method:"DELETE",body:e})}),getTokenInfo:e.query({query:e=>({url:"/wallets/token/info",params:e})}),getTokenPrice:e.query({query:e=>({url:"/wallets/token/price",params:e})}),addWalletToken:e.mutation({query:e=>({url:"/wallets/token/add",method:"POST",body:e}),async onQueryStarted(e,t){let{dispatch:a,queryFulfilled:n}=t;a(l.vB.setIsLoading(!0));try{let{data:e}=await n;e.ok&&e.data&&a(l.vB.addWalletToken(e.data))}catch(e){console.error("Add token failed:",e)}finally{a(l.vB.setIsLoading(!1))}}}),deleteWalletToken:e.mutation({query:e=>({url:"/wallets/token/delete",method:"DELETE",body:e}),async onQueryStarted(e,t){let{dispatch:a,queryFulfilled:n}=t;a(l.vB.setIsLoading(!0));try{await n,a(l.vB.removeWalletToken(e.token_id))}finally{a(l.vB.setIsLoading(!1))}}}),getWalletTransactions:e.query({query:e=>({url:"/wallets/transactions",params:e})}),swap:e.mutation({query:e=>({url:"/wallets/swap",method:"POST",body:e}),async onQueryStarted(e,t){let{dispatch:a,queryFulfilled:n}=t;a(l.vB.setIsLoading(!0));try{let{data:t}=await n;t&&t.data&&a(l.vB.updateTokensAfterSwap({swapParams:e,newFromBalance:t.data.newFromBalance,newToBalance:t.data.newToBalance,newWalletBalance:t.data.newWalletBalance}))}finally{a(l.vB.setIsLoading(!1))}}}),getTokenExtendedInfo:e.query({query:e=>({url:"/wallets/token/extended-info",params:e})}),estimateGas:e.mutation({query:e=>({url:"/wallets/estimate-swap-fee",method:"POST",body:e})}),getHistoricalQuotes:e.query({query:e=>({url:"/wallets/token/historical-quotes",params:e})})})}),{useGetWalletQuery:i,useGetWalletsQuery:d,useTransferMutation:s,useCreateWalletMutation:u,useImportWalletMutation:c,useDeleteWalletMutation:w,useGetTokenInfoQuery:f,useGetTokenPriceQuery:p,useAddWalletTokenMutation:T,useGetWalletTransactionsQuery:y,useSwapMutation:k,useLazyGetTokenPriceQuery:v,useGetTokenExtendedInfoQuery:m,useEstimateGasMutation:W,useGetHistoricalQuotesQuery:g,useLazyGetHistoricalQuotesQuery:S,useDeleteWalletTokenMutation:B,useGetTokenTransactionsQuery:E}=r},4015:function(e,t,a){a.d(t,{Zc:function(){return i},LN:function(){return u},iU:function(){return s},Vc:function(){return c.Vc},KR:function(){return c.KR},wg:function(){return c.wg},wR:function(){return c.wR},MX:function(){return c.MX},vB:function(){return w.vB},fK:function(){return f.fK},eI:function(){return w.eI}});var n,l,o,r,i,d,s,u,c=a(385);(n=i||(i={})).SOL="Solana",n.TON="The Open Network",n.ETH="Ethereum",n.BSC="Binance Smart Chain",(l=d||(d={})).IMPORTED="IMPORTED",l.GENERATED="GENERATED",(o=s||(s={})).SWAP="SWAP",o.DEPOSIT="DEPOSIT",o.TRANSFER="TRANSFER",(r=u||(u={})).FAILED="FAILED",r.PENDING="PENDING",r.SUCCESS="SUCCESS";var w=a(2433),f=a(7833)},385:function(e,t,a){a.d(t,{KR:function(){return r},MX:function(){return n},Vc:function(){return l},wR:function(){return o},wg:function(){return i}});let n=e=>e.wallet.wallets,l=e=>e.wallet.isLoading,o=e=>e.wallet.selectedWallet,r=e=>e.wallet.selectedNetwork,i=e=>e.wallet.selectedToken},2433:function(e,t,a){a.d(t,{eI:function(){return d},vB:function(){return i}});var n=a(4832),l=a(2351),o=a(2649);let r=(0,l.oM)({name:"wallet",initialState:{wallets:[],isLoading:!1,selectedWallet:void 0,selectedNetwork:void 0,selectedToken:void 0},reducers:{setWallets(e,t){e.wallets=t.payload},setIsLoading(e,t){e.isLoading=t.payload},setSelectedWallet(e,t){e.selectedWallet=t.payload,o.Z.set(n.nV,t.payload.id)},setSelectedNetwork(e,t){e.selectedNetwork=t.payload,o.Z.set(n.Ac,t.payload)},setSelectedToken(e,t){e.selectedToken=t.payload},clearSelectedToken(e){e.selectedToken=void 0},updateTokenAfterTransfer(e,t){e.selectedWallet&&(e.selectedWallet.tokens=e.selectedWallet.tokens.map(e=>e.id===t.payload.transferParams.token_id?{...e,balance:t.payload.newBalance}:e),e.selectedWallet.balance_usd=t.payload.newWalletBalance)},updateTokensAfterSwap(e,t){e.selectedWallet&&(e.selectedWallet.tokens=e.selectedWallet.tokens.map(e=>e.id===t.payload.swapParams.from_token_id?{...e,balance:t.payload.newFromBalance}:e.id===t.payload.swapParams.to_token_id?{...e,balance:t.payload.newToBalance}:e),e.selectedWallet.balance_usd=t.payload.newWalletBalance)},addWalletToken:(e,t)=>{e.selectedWallet&&(e.selectedWallet.tokens=[...e.selectedWallet.tokens,t.payload])},removeWalletToken(e,t){e.selectedWallet&&(e.selectedWallet.tokens=e.selectedWallet.tokens.filter(e=>e.id!==t.payload))}}}),{actions:i}=r,{reducer:d}=r},1101:function(e,t,a){a.d(t,{h:function(){return c}});var n=a(6074),l=a(8507);let o=()=>{var e,t;return(null===(t=window.Telegram)||void 0===t?void 0:null===(e=t.WebApp)||void 0===e?void 0:e.initData)||null},r=()=>{var e,t,a,n;return(null===(n=window.Telegram)||void 0===n?void 0:null===(a=n.WebApp)||void 0===a?void 0:null===(t=a.initDataUnsafe)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.id)||null},i=()=>{var e,t,a,n;return(null===(n=window.Telegram)||void 0===n?void 0:null===(a=n.WebApp)||void 0===a?void 0:null===(t=a.initDataUnsafe)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.username)||null},d=()=>{var e,t,a,n;return(null===(n=window.Telegram)||void 0===n?void 0:null===(a=n.WebApp)||void 0===a?void 0:null===(t=a.initDataUnsafe)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.language_code)||null},s=(0,n.ni)({baseUrl:"https://cryptoswaptg.ru/v1",credentials:"include",prepareHeaders:e=>{e.set("Content-Type","application/json");let t=o();t&&(e.set("X-Telegram-Init-Data",t),e.set("Authorization","tma ".concat(t)));let a=r();return a&&e.set("X-Telegram-ID",a.toString()),e}}),u=async(e,t,a)=>{let n=await s(e,t,a);if(n.error&&(401===n.error.status||403===n.error.status)){let l=r(),o=i(),u=d();l&&((await s({url:"/users/profile?telegram_id=".concat(l,"&username=").concat(o,"&language_code=").concat(u),method:"GET"},t,a)).data?n=await s(e,t,a):console.error("Failed to refresh session"))}return n},c=(0,l.LC)({baseQuery:u,reducerPath:"api",tagTypes:["User","Workspace","Ticker","Chart","Quote","Stock","Event"],refetchOnMountOrArgChange:!0,endpoints:e=>({})})},4832:function(e,t,a){a.d(t,{Ac:function(){return o},bq:function(){return n},nV:function(){return l}});let n="_auth.telegram_id",l="_app.wallet",o="_app.network"}}]);